# Telegram Session 생성 가이드

## 🔐 세션 문자열 생성

Telegram API를 사용하려면 세션 문자열이 필요합니다. 다음 단계를 따라 생성하세요.

## 📋 사전 준비

1. **Telegram 계정** - 전화번호로 등록된 Telegram 계정
2. **전화번호** - 국제 형식 (예: +821012345678)
3. **인증 코드 접근** - Telegram 앱에서 받을 수 있어야 함

## 🚀 세션 생성 방법

### 단계 1: 세션 생성 스크립트 실행

```bash
cd apps/api
yarn telegram:session
```

### 단계 2: 전화번호 입력

```
전화번호를 입력하세요 (예: +821012345678): +821012345678
```

**중요**: 
- 국가 코드 포함 (+82)
- 공백 없이 입력

### 단계 3: 인증 코드 입력

Telegram 앱에서 받은 코드를 입력:

```
Telegram에서 받은 인증 코드를 입력하세요: 12345
```

### 단계 4: 2단계 인증 (있는 경우)

2단계 인증을 설정한 경우:

```
2단계 인증 비밀번호를 입력하세요: ********
```

없으면 Enter 키만 누르세요.

### 단계 5: 세션 문자열 확인

성공하면 다음과 같이 표시됩니다:

```
✅ 로그인 성공!

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📝 생성된 TELEGRAM_SESSION_STRING:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1AGAOMTq8bAJAABrN... (긴 문자열)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💾 .env 파일에 다음과 같이 추가하세요:

TELEGRAM_SESSION_STRING=1AGAOMTq8bAJAABrN...
```

### 단계 6: .env 파일에 추가

`.env` 파일을 열고 생성된 세션 문자열을 추가:

```bash
nano .env
```

다음 줄을 수정:

```env
TELEGRAM_SESSION_STRING=1AGAOMTq8bAJAABrN... (복사한 문자열)
```

## ✅ 확인

서버를 실행하여 연결 확인:

```bash
yarn dev
```

로그에서 다음 메시지 확인:

```
✅ Telegram client connected successfully
```

## 🔧 문제 해결

### 인증 코드를 받지 못함

**원인**: 전화번호 형식 오류

**해결**:
- 국가 코드 확인 (+82)
- 공백 제거
- 010 → 10으로 변경 (예: +821012345678)

### PHONE_CODE_INVALID 오류

**원인**: 잘못된 인증 코드

**해결**:
- Telegram 앱에서 최신 코드 확인
- 빠르게 입력 (코드는 시간 제한 있음)
- 스크립트를 다시 실행

### PASSWORD_HASH_INVALID 오류

**원인**: 잘못된 2단계 인증 비밀번호

**해결**:
- 비밀번호 확인
- 2단계 인증이 없으면 Enter만 누르기

### FLOOD_WAIT 오류

**원인**: 너무 많은 시도

**해결**:
- 몇 분 대기 후 재시도
- 하루에 너무 많이 시도하지 않기

## 🔒 보안 주의사항

### ⚠️ 매우 중요!

세션 문자열은 **매우 민감한 정보**입니다!

1. **절대 공유하지 마세요**
   - GitHub에 커밋 금지
   - 메신저로 전송 금지
   - 스크린샷 공유 금지

2. **안전하게 보관**
   - `.env` 파일은 `.gitignore`에 포함
   - 환경변수로 관리
   - 비밀번호 관리자에 저장

3. **세션 무효화**
   - 의심스러운 경우 Telegram 앱에서 세션 종료
   - Settings > Privacy and Security > Active Sessions

## 📱 Telegram에서 세션 관리

### 현재 세션 확인

1. Telegram 앱 열기
2. Settings (설정)
3. Privacy and Security (개인정보 보호 및 보안)
4. Active Sessions (활성 세션)

### 세션 종료

의심스러운 세션이 있으면:
1. 해당 세션 선택
2. "Terminate" 클릭

## 🔄 세션 재생성

세션이 만료되었거나 문제가 있는 경우:

1. `.env`의 `TELEGRAM_SESSION_STRING` 비우기
2. 스크립트 재실행: `yarn telegram:session`
3. 새로운 세션 문자열 저장

## 💡 팁

1. **세션은 영구적**
   - 한 번 생성하면 계속 사용 가능
   - 매번 인증할 필요 없음

2. **여러 환경**
   - 개발/프로덕션 환경마다 별도 세션 사용 가능
   - 각각 다른 세션 문자열 생성

3. **백업**
   - 생성된 세션 문자열을 안전한 곳에 백업
   - 분실 시 재생성 필요

## 📞 추가 도움

문제가 계속되면:
1. Telegram API 문서: https://core.telegram.org/api
2. GramJS 문서: https://gram.js.org/
3. 프로젝트 README 참고
